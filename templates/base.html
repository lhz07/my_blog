<!doctype html>
<html lang="zh-CN" class="">
  {% if debug_mode %}
  <script>
    const ws = new WebSocket("ws://localhost:9001");
    ws.onmessage = (event) => {
      console.log("Reloading page...");
      window.location.reload(true);
    };
  </script>
  {% endif %}
  <script>
    let isDark = sessionStorage.getItem("is_dark_theme");
    if (isDark === null) {
      isDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
      sessionStorage.setItem("is_dark_theme", isDark);
    } else {
      isDark = isDark === "true";
    }
    if (isDark) {
      document.documentElement.classList.add("dark");
    }
  </script>
  {% block theme_button %}
  <script type="module">
    const themeToggleBtn = document.getElementById("theme-toggle");
    const sun = document.getElementById("icon-sun");
    const moon = document.getElementById("icon-moon");
    if (isDark) {
      // change to moon
      sun.classList.remove("opacity-100", "scale-100", "rotate-0", "ease-in");
      sun.classList.add("opacity-0", "scale-75", "-rotate-90", "ease-out");
      moon.classList.remove("opacity-0", "scale-75", "rotate-90", "ease-out");
      moon.classList.add("opacity-100", "scale-100", "rotate-0", "ease-in");
    }
    themeToggleBtn.addEventListener("click", () => {
      document.documentElement.classList.toggle("dark");
      const isDark = document.documentElement.classList.contains("dark");
      sessionStorage.setItem("is_dark_theme", isDark);
      if (isDark) {
        // 切到 Moon
        sun.classList.remove("opacity-100", "scale-100", "rotate-0", "ease-in");
        sun.classList.add("opacity-0", "scale-75", "-rotate-90", "ease-out");

        moon.classList.remove("opacity-0", "scale-75", "rotate-90", "ease-out");
        moon.classList.add("opacity-100", "scale-100", "rotate-0", "ease-in");
      } else {
        // 切回 Sun
        moon.classList.remove(
          "opacity-100",
          "scale-100",
          "rotate-0",
          "ease-in",
        );
        moon.classList.add("opacity-0", "scale-75", "rotate-90", "ease-out");

        sun.classList.remove("opacity-0", "scale-75", "-rotate-90", "ease-out");
        sun.classList.add("opacity-100", "scale-100", "rotate-0", "ease-in");
      }
    });
  </script>
  {% endblock theme_button %}
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    {% block head %}
    <title>{% block title %}{% endblock title %}</title>
    {% endblock head %}
    <link rel="stylesheet" type="text/css" href="/static/css/index.css" />
    <link rel="icon" type="image/png" href="/static/img/avatar.png" />
  </head>
  {% block header %}
  <header
    class="h-16 flex items-center justify-center shadow-sm bg-white dark:bg-slate-700"
  >
    <nav class="flex space-x-8 text-lg font-medium">
      <a
        href="/"
        class="transition-colors duration-200 {% if page == 'home' %}text-blue-600 dark:text-blue-300{% else %}hover:text-blue-600 dark:hover:text-blue-300 dark:text-slate-200{% endif %}"
        >Home</a
      >
      <a
        href="/search"
        class="transition-colors duration-200 {% if page == 'search' %}text-blue-600 dark:text-blue-300{% else %}hover:text-blue-600 dark:hover:text-blue-300 dark:text-slate-200{% endif %}"
        >Search</a
      >
      <a
        href="/about"
        class="transition-colors duration-200 {% if page == 'about' %}text-blue-600 dark:text-blue-300{% else %}hover:text-blue-600 dark:hover:text-blue-300 dark:text-slate-200{% endif %}"
        >About</a
      >
      <a
        href="/friend_links"
        class="transition-colors duration-200 {% if page == 'friend_links' %}text-blue-600 dark:text-blue-300{% else %}hover:text-blue-600 dark:hover:text-blue-300 dark:text-slate-200{% endif %}"
        >Friend Links</a
      >
    </nav>
    <button
      id="theme-toggle"
      class="absolute right-4 p-2 w-10 h-10 flex items-center justify-center group text-black dark:text-slate-200 hover:text-blue-600 dark:hover:text-blue-300"
    >
      <!-- Sun icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        id="icon-sun"
        class="absolute w-[22px] h-[22px] opacity-100 scale-100 rotate-0 transition-all duration-200 ease-in fill-current"
      >
        <path
          d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM80-440q-17 0-28.5-11.5T40-480q0-17 11.5-28.5T80-520h80q17 0 28.5 11.5T200-480q0 17-11.5 28.5T160-440H80Zm720 0q-17 0-28.5-11.5T760-480q0-17 11.5-28.5T800-520h80q17 0 28.5 11.5T920-480q0 17-11.5 28.5T880-440h-80ZM480-760q-17 0-28.5-11.5T440-800v-80q0-17 11.5-28.5T480-920q17 0 28.5 11.5T520-880v80q0 17-11.5 28.5T480-760Zm0 720q-17 0-28.5-11.5T440-80v-80q0-17 11.5-28.5T480-200q17 0 28.5 11.5T520-160v80q0 17-11.5 28.5T480-40ZM226-678l-43-42q-12-11-11.5-28t11.5-29q12-12 29-12t28 12l42 43q11 12 11 28t-11 28q-11 12-27.5 11.5T226-678Zm494 495-42-43q-11-12-11-28.5t11-27.5q11-12 27.5-11.5T734-282l43 42q12 11 11.5 28T777-183q-12 12-29 12t-28-12Zm-42-495q-12-11-11.5-27.5T678-734l42-43q11-12 28-11.5t29 11.5q12 12 12 29t-12 28l-43 42q-12 11-28 11t-28-11ZM183-183q-12-12-12-29t12-28l43-42q12-11 28.5-11t27.5 11q12 11 11.5 27.5T282-226l-42 43q-11 12-28 11.5T183-183Zm297-297Z"
        />
      </svg>
      <!-- Moon icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        id="icon-moon"
        class="absolute w-[22px] h-[22px] opacity-0 scale-75 rotate-90 transition-all duration-200 ease-out fill-current"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
      >
        <path
          d="M480-120q-151 0-255.5-104.5T120-480q0-138 90-239.5T440-838q13-2 23 3.5t16 14.5q6 9 6.5 21t-7.5 23q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q11-7 22.5-6.5T819-479q10 5 15.5 15t3.5 24q-14 138-117.5 229T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Zm-10-270Z"
        />
      </svg>
    </button>
  </header>
  {% endblock header %}
  <body
    class="flex flex-col justify-between min-h-screen font-sans leading-normal tracking-normal dark:bg-slate-800"
  >
    {% block main %}
    <main class="container flex-1 w-full md:max-w-3xl mx-auto">
      {% block content %}{% endblock content %}
    </main>
    {% endblock main %} {% block footer %}
    <footer class="container mx-auto px-6 pb-2 pt-6 md:max-w-4xl">
      <div class="px-6 py-4 text-center">
        <p class="text-sm text-gray-600 dark:text-gray-400">
          &copy; 2025 by
          <a
            href="https://lhz07.com/"
            class="font-medium text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 hover:text-blue-600 transition-colors duration-200"
          >
            lhz07
          </a>
        </p>
        <a
          href="https://icp.gov.moe/?keyword=20257027"
          class="text-sm text-gray-600 dark:text-gray-400"
          target="_blank"
          >萌ICP备20257027号</a
        >
      </div>
    </footer>
    {% endblock footer %} {% block scripts %}{% endblock scripts %}
  </body>
</html>
