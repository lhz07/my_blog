<!doctype html>
<html lang="zh-CN" class="">
  {% if debug_mode %}
  <script>
    const ws = new WebSocket("ws://localhost:9001");
    ws.onmessage = (event) => {
      console.log("Reloading page...");
      window.location.reload(true);
    };
  </script>
  {% endif %}
  <script>
    let isDark = sessionStorage.getItem("is_dark_theme");
    if (isDark === null) {
      isDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
      sessionStorage.setItem("is_dark_theme", isDark);
    } else {
      isDark = isDark === "true";
    }
    if (isDark) {
      document.documentElement.classList.add("dark");
    }
  </script>
  <script type="module">
    const themeToggleBtn = document.getElementById("theme-toggle");
    const sun = document.getElementById("icon-sun");
    const moon = document.getElementById("icon-moon");
    if (isDark) {
      // change to moon
      sun.classList.remove("opacity-100", "scale-100", "rotate-0", "ease-in");
      sun.classList.add("opacity-0", "scale-75", "-rotate-90", "ease-out");
      moon.classList.remove("opacity-0", "scale-75", "rotate-90", "ease-out");
      moon.classList.add("opacity-100", "scale-100", "rotate-0", "ease-in");
    }
    themeToggleBtn.addEventListener("click", () => {
      document.documentElement.classList.toggle("dark");
      const isDark = document.documentElement.classList.contains("dark");
      sessionStorage.setItem("is_dark_theme", isDark);
      if (isDark) {
        // 切到 Moon
        sun.classList.remove("opacity-100", "scale-100", "rotate-0", "ease-in");
        sun.classList.add("opacity-0", "scale-75", "-rotate-90", "ease-out");

        moon.classList.remove("opacity-0", "scale-75", "rotate-90", "ease-out");
        moon.classList.add("opacity-100", "scale-100", "rotate-0", "ease-in");
      } else {
        // 切回 Sun
        moon.classList.remove(
          "opacity-100",
          "scale-100",
          "rotate-0",
          "ease-in",
        );
        moon.classList.add("opacity-0", "scale-75", "rotate-90", "ease-out");

        sun.classList.remove("opacity-0", "scale-75", "-rotate-90", "ease-out");
        sun.classList.add("opacity-100", "scale-100", "rotate-0", "ease-in");
      }
    });
  </script>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    {% block head %}
    <title>{% block title %}{% endblock title %}</title>
    {% endblock head %}
    <link rel="stylesheet" type="text/css" href="/static/css/index.css" />
    <link rel="icon" type="image/png" href="/static/img/avatar.png" />
  </head>
  {% block header %}
  <header
    class="h-16 flex items-center justify-center shadow-sm bg-white dark:bg-slate-700"
  >
    <nav class="flex space-x-8 text-lg font-medium">
      <a
        href="/"
        class="transition-colors duration-200 {% if page == 'home' %}text-blue-600 dark:text-blue-300{% else %}hover:text-blue-600 dark:hover:text-blue-300 dark:text-slate-200{% endif %}"
        >Home</a
      >
      <a
        href="/about"
        class="transition-colors duration-200 {% if page == 'about' %}text-blue-600 dark:text-blue-300{% else %}hover:text-blue-600 dark:hover:text-blue-300 dark:text-slate-200{% endif %}"
        >About</a
      >
      <a
        href="/friend_links"
        class="transition-colors duration-200 {% if page == 'friend_links' %}text-blue-600 dark:text-blue-300{% else %}hover:text-blue-600 dark:hover:text-blue-300 dark:text-slate-200{% endif %}"
        >Friend Links</a
      >
    </nav>
    <button
      id="theme-toggle"
      class="absolute right-4 p-2 w-10 h-10 flex items-center justify-center group text-black dark:text-slate-200 hover:text-blue-600 dark:hover:text-blue-300"
    >
      <!-- Sun icon -->
      <svg
        id="icon-sun"
        class="absolute w-[22px] h-[22px] opacity-100 scale-100 rotate-0 transition-all duration-200 ease-in fill-current"
        viewBox="0 -960 960 960"
      >
        <path
          d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Zm326-268Z"
        ></path>
      </svg>

      <!-- Moon icon -->
      <svg
        id="icon-moon"
        class="absolute w-[22px] h-[22px] opacity-0 scale-75 rotate-90 transition-all duration-200 ease-out fill-current"
        viewBox="0 -960 960 960"
      >
        <path
          d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Zm-10-270Z"
        ></path>
      </svg>
    </button>
  </header>
  {% endblock header %}
  <body
    class="flex flex-col justify-between min-h-screen font-sans leading-normal tracking-normal dark:bg-slate-800"
  >
    <main class="container flex-1 w-full md:max-w-3xl mx-auto">
      {% block content %}{% endblock content %}
    </main>
    {% block footer %}
    <footer class="container mx-auto px-6 pb-2 pt-6 md:max-w-4xl">
      <div class="px-6 py-4 text-center">
        <p class="text-sm text-gray-600 dark:text-gray-400">
          &copy; 2025 by
          <a
            href="https://lhz07.com/"
            class="font-medium text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 hover:text-blue-600 transition-colors duration-200"
          >
            lhz07
          </a>
        </p>
        <a
          href="https://icp.gov.moe/?keyword=20257027"
          class="text-sm text-gray-600 dark:text-gray-400"
          target="_blank"
          >萌ICP备20257027号</a
        >
      </div>
    </footer>
    {% endblock footer %} {% block scripts %}{% endblock scripts %}
  </body>
</html>
